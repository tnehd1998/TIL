# 스코프란?

먼저 영어 단어 자체로 접근해보면
스코프(Scope)는 범위라는 의미를 가진다.

자바스크립트에서도 해당 단어 뜻의 의미와
흡사하며 식별자 접근 규칙에 따른 유효 범위를 뜻한다.

- 즉, 식별자가 유효한 범위를 의미한다.
  - 식별자 : 변수, 함수, 클래스

## 그래서 왜 필요할까?

스코프가 없다면 같은 식별자 이름 충돌을 일으키게 되며,
프로그램 전체에서 해당 식별자 이름을 유일해야 한다.

하지만 스코프를 통해 식별자인 변수 이름의 충돌을 방지하며,
다른 스코프에서 같은 이름의 변수를 사용할 수 있게 한다.

# 스코프의 구분

스코프는 크게 두가지 종류로 나눌 수 있으며,
전역 스코프와 지역 스코프로 나뉜다.

## 전역 스코프

말 그대로 전역(Global)은
어느 곳에서든 접근하여 사용할 수 있는 스코프를 의미하며,
모든 지역 스코프의 최상위 스코프는 전역 스코프다.

- 브라우저 : window
- Node.js : global

전역에 특정 변수를 선언하면
전역 스코프를 갖는 전역 변수가 되며
해당 변수는 어디서든지 참조하여 활용할 수 있다.

- 전역 변수 : 전역 스코프에 선언된 변수

### 전역 변수 생성을 지양해야 하는 이유

함수가 종료하면 함께 없어지는 지역 변수와 달리,
전역 변수는 어플리케이션의 생명주기와 동일하다.
해당 상황은 다음과 같은 문제들을 초래할 수 있다.

1. 암묵적 결합
   - 모든 코드가 전역 변수를 참조하고 변경할 수 있기에, 코드의 가독성도 나빠지고, 의도치 않게 상태가 변경될 위험이 있다.
2. 긴 생명 주기
   - 어플리케이션이 종료될 때까지 전역 변수는 메모리에 할당되어 있다.
3. 스코프 체인에서 가장 마지막에 확인됨
   - 전역 변수는 스코프 체인에서 가장 마지막에 검색이 된다.

### 스코프 체인이란?

영어 단어 자체로 접근해보면
스코프(Scope) + 체인(Chain)는 범위가 연결되어 있다는 의미를 가진다
즉, 스코프가 계층적으로 연결되어 있음을 의미한다.

모든 스코프는 하나의 계층적 구조로 연결되며,
모든 지역 스코프의 최상위 스코프에는
전역 스코프가 위치한다.

- 변수 탐색 원리

1. 해당 변수를 참조하는 지역 스코프에서 해당하는 변수를 찾는다.
2. 존재하지 않는다면 상위 스코프 방향으로 올라가 맞는 변수를 찾는다.
3. 전역 스코프까지 거슬러 올라가도 없다면 해당 변수는 존재하지 않는다.

## 지역 스코프

말 그대로 지역(Local)은
특정 지역에서만 접근할 수 있는 스코프를 의미하며,
해당 지역을 벗어난 곳에서는 접근을 할 수 없다.

지역에 특정 변수를 선언하면
지역 스코프를 갖는 지역 변수가 되며,
해당 변수를 자신의 지역 스코프와
하위 스코프에서만 참조할 수 있다.

- 지역 변수 : 지역 스코프에 선언된 변수

# 자바스크립트 스코프의 특징

보통 다른 언어는 블록 레벨 스코프의 원리를 통해 지역 스코프를 생성한다.

- 블록 레벨 스코프 : 함수 뿐만 아닌 모든 코드블록이 지역 스코프를 만든다.

하지만, 자바스크립트는 다른 언어들과 달리 함수 레벨 스코프의 원리를 통해 지역 스코프가 생성된다.

- 함수 레벨 스코프 : 함수로 정의된 코드 블록만 지역 스코프로 인정한다.

### var을 지양해야 하는 이유

var를 사용하게 되면,
자바스크립트의 함수 레벨 스코프로 인해
if, switch와 같은 코드 블록을 사용할 때
의도치 않은 전역 변수의 중복 생성, 값의 재할당이
발생할 가능성이 매우 높다.

그렇기에 ES6에서 추가된
let과 const를 활용하면
블록 레벨 스코프를 사용할 수 있다.

# 상위 스코프를 결정하는 방식

특정 변수를 찾을 때,
해당 지역 스코프에 해당 변수가 존재하지 않는다면,
상위 스코프에서 해당 변수를 찾게 된다.

상위 스코프를 찾는 방법은 두가지이며
동적 스코프와 렉시컬 스코프(정적 스코프)이다.

1. 동적 스코프

- 함수가 호출되는 시점을 기준으로 동적으로 상위 스코프를 결정하는 것을 의미한다.

2. 렉시컬 스코프 (정적 스코프)

- 함수 정의가 되는 시점을 기준을 정적으로 상위 스코프를 결정하는 것을 의미한다.

자바스크립트는 렉시컬 스코프를 따르기에,
함수를 어디서 정의했는지에 따라
상위 스코프가 결정된다.

# 내용 요약

- 자바스크립트 스코프는 전역 스코프 & 지역 스코프로 나뉜다
- 자바스크립트 특정 변수 탐색 방식
  1. 지역 스코프에서 해당 변수를 찾는다
  2. 존재하지 않으면 상위 스코프에서 변수를 찾는다.
     - 렉시컬 스코프를 따라 상위 스코프를 결정한다.

## 참고한 자료

- 모던 자바스크립트 Deep Dive
- [https://hanamon.kr/javascript-스코프와-변수선언키워드-차이점/](https://hanamon.kr/javascript-%EC%8A%A4%EC%BD%94%ED%94%84%EC%99%80-%EB%B3%80%EC%88%98%EC%84%A0%EC%96%B8%ED%82%A4%EC%9B%8C%EB%93%9C-%EC%B0%A8%EC%9D%B4%EC%A0%90/)
- [https://poiemaweb.com/js-scope](https://poiemaweb.com/js-scope)
