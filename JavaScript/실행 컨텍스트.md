# 실행 컨텍스트란?

컨텍스트라는 말을 한국어로 직역하면
문맥, 맥략으로 변역된다.

즉, 실행 컨텍스트는
자바스크립트의 동작 원리를
담고 있는 핵심 개념이다.

# 실행 컨텍스트의 타입

ECMAScript 사양은 소스코드를 4가지 타입으로 구분하며
4가지 타입의 소스코드는 실행 컨텍스트를 생성한다.

4가지 타입으로 구분하는 이유는
소스코드의 타입에 따라
실행 컨텍스트를 생성 및 관리하는 내용이
다르기 때문이다.

1. 전역 실행 컨텍스트
   - 전역에 존재하는 코드에 의해 생성되는 실행 컨텍스트다.
   - 최상위 스코프인 전역 스코프를 생성하고, 전역 변수를 관리한다.
     - 전역에 정의된 함수, 클래스 등의 내부 코드는 포함되지 않는다.
   - 전역에 존재하는 코드가 평가되면 전역 실행 컨텍스트가 생성된다.
2. 함수 실행 컨텍스트
   - 함수 내부에 존재하는 코드에 의해 생성되는 실행 컨텍스트다.
     - 함수 내부에 중첩된 함수, 클래스 등의 내부 코드는 포함되지 않는다.
   - 함수에 존재하는 코드가 평가되면 함수 실행 컨텍스트가 생성된다.
3. eval 실행 컨텍스트 (현재는 eval을 사용하지 않기에 무시해도 된다)
   - 예전에 사용했던 eval 코드가 평가되면 생성됐던 eval 실행 컨텍스트다.
   - 현재 해킹의 위험으로 인해 eval의 사용을 하지 않는다.
4. 모듈 실행 컨텍스트
   - 모듈 내부에 존재하는 코드에 의해 생성되는 실행 컨텍스트다.
     - 모듈 내부의 함수, 클래스 등의 내부 코드는 포함되지 않는다.
   - 모듈에 존재하는 코드가 평가되면 모듈 실행 컨텍스트가 생성된다.

# 자바스크립트 엔진의 실행 과정

모든 소스코드는 실행하기 전에
작성된 모든 코드의 평가과정을 통해
코드를 실행할 수 있는 준비 과정을 거친다.

자바스크립트 엔진은 작동 과정을
소스코드 평가와 소스코드 실행 과정으로
나누어 각자 다른 작업을 처리한다.

## 소스코드의 평가

1. 실행 컨텍스트의 생성
2. 변수, 함수등의 선언문을 실행 및 실행 컨텍스트가 관리하는 스코프에 등록
   - 실행 컨텍스트가 관리하는 스코프 = 렉시컬 환경의 환경 레코드

### 렉시컬 환경

렉시컬 환경은 스코프와 식별자를 관리하며
상위 스코프에 대한 참조를 기록하는 역할을 한다.

렉시컬 환경은 스코프를 구분하여
식별자를 등록하고 관리하는 저장소 역할을 하며
두 개의 컴포넌트로 구성된다.

1. 환경 레코드

   - 스코프에 포함된 식별자 등록 및 바인딩된 값을 관리하는 저장소

2. 외부 렉시컬 환경에 대한 참조

   - 상위 스코프를 가리키는 역할을 한다.

## 소스코드의 실행

1. 런타임 환경에서 선언문을 제외한 소스코드가 순차적으로 실행
2. 실행에 필요한 정보를 렉시컬 환경의 환경 레코드에 검색하여 취득하며 작업을 이어나간다.

```jsx
let number; // 소스코드의 평가
number = 10; // 소스코드의 실행
```

## 실행 컨텍스트의 역할

코드를 실행시키려면
스코프, 식별자, 코드 실행 순서 등의
관리가 필요하다.

해당 작업의 관리를 해주는 것이
바로 실행 컨텍스트다.

실행 컨텍스트는 소스코드를 실행하는데
필요한 환경을 제공하고
코드의 실행 결과를 관리하는 영역이다.

실행 컨텍스트는 현재 진행되고 있는
코드의 실행 순서를
실행 컨텍스트 스택을 활용하여
순차적으로 코드가 실행되도록 한다.

## 실행 컨텍스트 스택

실행 컨텍스트 스택은
콜 스택이라고도 불리며,
생성된 실행 컨텍스트들을
스택 자료구조를 활용하여 관리하는 스택이다.

자료구조의 스택처럼
현재 실행되어야 할 실행 컨텍스트를 push하고,
스택 맨 위에있는 실행 컨텍스트를 처리한 후 pop하는
원리로 작동된다.

# 참고한 자료

- 모던 자바스크립트 Deep Dive
- [https://www.zerocho.com/category/JavaScript/post/5741d96d094da4986bc950a0](https://www.zerocho.com/category/JavaScript/post/5741d96d094da4986bc950a0)
- [https://velog.io/@ggong/자바스크립트의-실행-컨텍스트-execution-context](https://velog.io/@ggong/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EC%9D%98-%EC%8B%A4%ED%96%89-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8-execution-context)
- [https://github.com/dongkyun-dev/TIL/blob/master/JS/✔✔실행 컨텍스트.md](https://github.com/dongkyun-dev/TIL/blob/master/JS/%E2%9C%94%E2%9C%94%EC%8B%A4%ED%96%89%20%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8.md)
